<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>CEYO — Evidentiary Infrastructure for Autonomous Systems</title>
  <meta name="description" content="CEYO is a weight-neutral, policy-scoped integrity layer. Canonical artifacts. Cryptographic sealing. Independent verification under constrained disclosure."/>
  <meta name="theme-color" content="#060A13"/>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500&family=Inter:wght@300;400;500;600&family=Outfit:ital,wght@0,700;0,900;1,900&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root{
      --navy:#060A13;
      --navy2:#0B1220;
      --ivory:#F4F0E6;
      --royal:#2D67FF;
      --royal-glow: rgba(45,103,255,0.40);
      --text:rgba(244,240,230,.92);
      --muted:rgba(244,240,230,.56);
      --stroke:rgba(244,240,230,.10);
      --brandFont:'Outfit', system-ui, sans-serif;
      --monoFont:'IBM Plex Mono', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --bodyFont:'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    html{scroll-behavior:smooth; background:var(--navy);}
    body{
      margin:0; background:var(--navy); color:var(--text);
      font-family:var(--bodyFont); overflow-x:hidden; cursor:none;
    }
    @media (pointer: coarse){
      body{ cursor:auto; }
      #cursor{ display:none; }
    }

    /* Background + WebGL stage */
    #stage{
      position:fixed; inset:0; z-index:0; pointer-events:none;
      background:
        radial-gradient(1200px 700px at 50% 22%, rgba(45,103,255,.12), transparent 62%),
        radial-gradient(900px 520px at 18% 74%, rgba(45,103,255,.07), transparent 65%),
        linear-gradient(180deg, var(--navy), var(--navy2));
    }
    #gl{ width:100%; height:100%; display:block; }

    /* Grain */
    #grain{
      position:fixed; inset:0; z-index:2; pointer-events:none; opacity:.05;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='320' height='320'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='320' height='320' filter='url(%23n)'/%3E%3C/svg%3E");
    }

    /* Cursor */
    #cursor{
      position:fixed; z-index:9999; width:10px; height:10px; border-radius:50%;
      background:var(--ivory); mix-blend-mode:difference; pointer-events:none;
      transform:translate(-50%,-50%);
      transition: width .16s ease, height .16s ease, opacity .16s ease;
    }
    #cursor.big{ width:42px; height:42px; opacity:.55; background: var(--royal); }

    /* Nav */
    #topnav{
      position:fixed; top:0; left:0; right:0; z-index:50;
      padding: 22px 32px;
      display:flex; justify-content:space-between; align-items:center;
      transition: background .25s ease, border-color .25s ease, backdrop-filter .25s ease;
      border-bottom:1px solid transparent;
    }
    #topnav.scrolled{
      background: rgba(6,10,19,.70);
      backdrop-filter: blur(14px);
      border-bottom-color: rgba(244,240,230,.08);
    }

    /* Telemetry shimmer */
    .shimmer-text{
      background: linear-gradient(90deg, rgba(244,240,230,0) 0%, var(--royal) 50%, rgba(244,240,230,0) 100%);
      background-size: 200% auto;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: shimmerMove 2.8s ease-in-out infinite;
    }
    @keyframes shimmerMove { 0%{background-position:0% center;} 60%{background-position:100% center;} 100%{background-position:100% center;} }

    .h1{
      font-family: var(--brandFont);
      font-weight: 900;
      font-size: clamp(50px, 9vw, 120px);
      line-height: 0.9;
      letter-spacing: -0.05em;
      text-transform: uppercase;
    }

    /* Buttons */
    .btn{
      display:inline-flex; align-items:center; justify-content:center;
      font-family:var(--monoFont);
      font-size:10px;
      letter-spacing:.20em;
      text-transform:uppercase;
      border-radius:999px;
      padding: 16px 32px;
      border:1px solid var(--stroke);
      transition: transform .18s ease, box-shadow .18s ease, background .18s ease, border-color .18s ease, color .18s ease;
      user-select:none;
    }
    .btn.primary{
      background: var(--royal);
      border-color: rgba(45,103,255,.85);
      color: #fff;
    }
    .btn:hover{
      transform: translateY(-1px);
      box-shadow: 0 0 26px var(--royal-glow);
      border-color: rgba(45,103,255,.75);
    }
    .btn.ghost:hover{ background: rgba(244,240,230,.05); }

    /* Expand blocks */
    .data-block{
      border: 1px solid var(--stroke);
      background: rgba(11,18,32,0.40);
      backdrop-filter: blur(10px);
      transition: all 0.40s cubic-bezier(0.16, 1, 0.3, 1);
      cursor: pointer;
      overflow: hidden;
      max-height: 84px;
      border-radius: 18px;
    }
    .data-block:hover{ border-color: rgba(45,103,255,.55); background: rgba(45,103,255,0.05); }
    .data-block.expanded{
      max-height: 560px;
      border-color: rgba(45,103,255,.85);
      background: rgba(45,103,255,0.06);
      box-shadow: 0 22px 60px rgba(0,0,0,.35);
    }
    .data-block .content{
      opacity: 0;
      transform: translateY(8px);
      transition: opacity 0.28s ease, transform 0.28s ease;
      pointer-events: none;
    }
    .data-block.expanded .content{
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }

    /* Bottom bar */
    #bottombar{
      position:fixed; bottom:0; left:0; right:0; z-index:50;
      height:56px;
      background: rgba(6,10,19,.88);
      backdrop-filter: blur(12px);
      border-top: 1px solid var(--stroke);
      display:flex;
      font-family: var(--monoFont);
      font-size: 9px;
      letter-spacing: .22em;
      text-transform: uppercase;
    }
    #bottombar a{
      flex:1; display:flex; align-items:center; justify-content:center;
      border-right: 1px solid var(--stroke);
      transition: background .16s ease, color .16s ease;
      color: rgba(244,240,230,.70);
    }
    #bottombar a:last-child{ border-right:none; }
    #bottombar a:hover{ background: rgba(244,240,230,.05); color: rgba(244,240,230,.92); }
    #bottombar a.active{
      color: rgba(244,240,230,.92);
      box-shadow: inset 0 2px 0 rgba(45,103,255,.95);
    }

    .section-pad{ padding-top: 11rem; padding-bottom: 11rem; }
    @media (max-width: 640px){
      .section-pad{ padding-top: 8rem; padding-bottom: 8rem; }
      #topnav{ padding: 18px 18px; }
    }
  </style>
</head>

<body>
  <div id="stage" aria-hidden="true"><canvas id="gl"></canvas></div>
  <div id="grain" aria-hidden="true"></div>
  <div id="cursor" aria-hidden="true"></div>

  <nav id="topnav" aria-label="Primary navigation">
    <div class="flex items-baseline gap-4">
      <a href="index.html" class="font-[var(--brandFont)] font-black text-2xl italic">CEYO</a>
      <span class="font-mono text-[9px] tracking-[0.30em] opacity-40 uppercase">Evidentiary Infrastructure</span>
    </div>
    <div class="hidden md:flex gap-8 font-mono text-[10px] tracking-widest uppercase opacity-60">
      <a href="#hero" class="hover:text-[var(--royal)] transition-colors">Index</a>
      <a href="#gap" class="hover:text-[var(--royal)] transition-colors">Gap</a>
      <a href="#substrate" class="hover:text-[var(--royal)] transition-colors">Substrate</a>
      <a href="#tech" class="hover:text-[var(--royal)] transition-colors">Tech</a>
      <a href="#boundary" class="hover:text-[var(--royal)] transition-colors">Governance</a>
      <a href="contact.html" class="hover:text-[var(--royal)] transition-colors">Contact</a>
    </div>
  </nav>

  <div class="relative z-10 max-w-7xl mx-auto px-6">
    <section id="hero" class="min-h-screen flex flex-col justify-center">
      <div class="max-w-4xl">
        <div class="font-mono text-[10px] tracking-[0.40em] text-[var(--royal)] mb-6 uppercase">Initializing Integrity Substrate</div>
        <h1 class="h1 mb-8">
          Go Beyond<br/>
          <span class="shimmer-text italic">Telemetry</span>
        </h1>

        <p class="text-xl text-[var(--muted)] leading-relaxed max-w-2xl mb-12">
          CEYO is a weight-neutral, policy-scoped evidentiary layer that attaches beside AI inference systems and produces canonical artifacts representing defined inference-time decision-state context — cryptographically sealed for institutional verification under constrained disclosure conditions.
        </p>

        <div class="flex gap-6 flex-wrap">
          <button onclick="document.getElementById('tech').scrollIntoView({behavior:'smooth'})" class="btn primary">Enter Framework</button>
          <a href="contact.html" class="btn ghost">Request Review</a>
        </div>

        <div class="mt-10 space-y-3 font-mono text-[11px] uppercase tracking-wider">
          <div class="text-red-400/70">× CEYO does not replace models</div>
          <div class="text-red-400/70">× CEYO does not modify inference outputs</div>
          <div class="text-red-400/70">× CEYO does not evaluate correctness</div>
          <div class="text-[var(--royal)]">→ CEYO produces verifiable records</div>
        </div>
      </div>
    </section>

    <section id="gap" class="section-pad">
      <div class="grid lg:grid-cols-2 gap-20">
        <div>
          <h2 class="font-[var(--brandFont)] italic font-black text-5xl uppercase mb-8">The Accountability Gap</h2>
          <p class="text-[var(--muted)] leading-loose text-lg mb-8">
            Modern AI deployments optimize for throughput, latency, and availability. Accountability infrastructure is frequently secondary.
          </p>
          <p class="text-[var(--muted)] leading-loose text-lg mb-8">
            When a decision is later questioned — through regulatory inquiry, internal audit, incident review, or litigation — organizations often reconstruct events from partial logs and distributed traces.
            Reconstruction is interpretive. It is not deterministic.
          </p>
          <p class="text-[var(--muted)] leading-loose text-lg">
            Institutions require artifacts that are canonical in structure, explicit in capture scope, cryptographically sealed, and independently verifiable. This is an architectural deficit, not an operational oversight.
          </p>

          <div class="mt-10 border-t border-[var(--stroke)] pt-8">
            <div class="font-mono text-[10px] tracking-[0.30em] text-[var(--royal)] uppercase mb-4">Core Principle</div>
            <div class="text-[var(--text)] text-lg font-semibold leading-snug">
              Evidence infrastructure must remain separate from decision authority.
            </div>
            <div class="text-[var(--muted)] mt-2">CEYO provides the artifact. Institutions provide the oversight.</div>
          </div>
        </div>

        <div class="space-y-4">
          <div class="data-block p-6" data-open="canonical" onclick="toggleBlock(this)">
            <div class="flex justify-between items-center mb-4">
              <span class="font-mono text-[10px] text-[var(--royal)] tracking-[0.20em] uppercase">01 / Canonical</span>
              <span class="text-xs uppercase font-bold">Deterministic structure</span>
            </div>
            <div class="content pt-4 border-t border-[var(--stroke)] text-sm leading-relaxed text-[var(--muted)]">
              Consistent schema and stable byte representation across environments. Canonicalization produces deterministic output for independent recomputation.
            </div>
          </div>

          <div class="data-block p-6" data-open="integrity" onclick="toggleBlock(this)">
            <div class="flex justify-between items-center mb-4">
              <span class="font-mono text-[10px] text-[var(--royal)] tracking-[0.20em] uppercase">02 / Integrity</span>
              <span class="text-xs uppercase font-bold">Cryptographic sealing</span>
            </div>
            <div class="content pt-4 border-t border-[var(--stroke)] text-sm leading-relaxed text-[var(--muted)]">
              After canonicalization, hashing and digital signatures establish tamper-evidence and origin authenticity. Artifacts become independently verifiable records.
            </div>
          </div>

          <div class="data-block p-6" data-open="scope" onclick="toggleBlock(this)">
            <div class="flex justify-between items-center mb-4">
              <span class="font-mono text-[10px] text-[var(--royal)] tracking-[0.20em] uppercase">03 / Scope</span>
              <span class="text-xs uppercase font-bold">Explicit disclosure boundary</span>
            </div>
            <div class="content pt-4 border-t border-[var(--stroke)] text-sm leading-relaxed text-[var(--muted)]">
              Versioned policy defines inclusion, exclusion, masking, and tiered disclosure pre-generation. Artifacts reflect declared scope; they do not implicitly expand beyond it.
            </div>
          </div>

          <div class="data-block p-6" data-open="separation" onclick="toggleBlock(this)">
            <div class="flex justify-between items-center mb-4">
              <span class="font-mono text-[10px] text-[var(--royal)] tracking-[0.20em] uppercase">04 / Separation</span>
              <span class="text-xs uppercase font-bold">Oversight without exposure</span>
            </div>
            <div class="content pt-4 border-t border-[var(--stroke)] text-sm leading-relaxed text-[var(--muted)]">
              Verification without default disclosure of proprietary internals. Oversight can confirm integrity under policy scope without requiring model weight exposure.
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="substrate" class="section-pad">
      <div class="max-w-4xl">
        <div class="font-mono text-[10px] tracking-[0.40em] text-[var(--royal)] mb-4 uppercase">System Architecture</div>
        <h2 class="font-[var(--brandFont)] italic font-black text-6xl uppercase mb-8">A Decoupled Evidentiary Substrate</h2>
        <p class="text-[var(--muted)] leading-loose text-lg mb-8">
          CEYO attaches at the inference boundary — as a sidecar, wrapper, or gateway — and captures only what operator policy explicitly defines.
          It normalizes captured fields into a stable artifact schema, applies deterministic canonicalization, and seals cryptographically under a non-custodial key architecture.
        </p>
        <p class="text-[var(--muted)] leading-loose text-lg mb-10">
          Verification confirms integrity and provenance under declared policy scope. It does not confirm correctness of model output.
        </p>
      </div>
    </section>

    <section id="tech" class="section-pad">
      <div class="text-center mb-20">
        <div class="font-mono text-[10px] tracking-[0.40em] text-[var(--royal)] mb-4 uppercase">Substrate Properties</div>
        <h2 class="font-[var(--brandFont)] italic font-black text-6xl uppercase">Technical Core</h2>
      </div>

      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
        <div class="data-block p-8" data-open="capture" onclick="toggleBlock(this)">
          <div class="font-mono text-[10px] text-[var(--royal)] mb-4 tracking-[0.20em] uppercase">01 · Capture</div>
          <div class="font-bold text-lg mb-2 uppercase italic">Policy-scoped</div>
          <div class="content mt-4 text-[var(--muted)] text-sm leading-relaxed">
            Operators define what fields are included, excluded, and masked before artifact generation begins. Capture policy is explicit and versioned. The policy version is recorded within the artifact.
          </div>
        </div>

        <div class="data-block p-8" data-open="structure" onclick="toggleBlock(this)">
          <div class="font-mono text-[10px] text-[var(--royal)] mb-4 tracking-[0.20em] uppercase">02 · Structure</div>
          <div class="font-bold text-lg mb-2 uppercase italic">Canonical</div>
          <div class="content mt-4 text-[var(--muted)] text-sm leading-relaxed">
            Captured context is normalized into a deterministic JSON artifact schema. Canonicalization produces a stable byte representation independent of serialization order, enabling independent recomputation of integrity hashes without interpretive variance.
          </div>
        </div>

        <div class="data-block p-8" data-open="sealing" onclick="toggleBlock(this)">
          <div class="font-mono text-[10px] text-[var(--royal)] mb-4 tracking-[0.20em] uppercase">03 · Sealing</div>
          <div class="font-bold text-lg mb-2 uppercase italic">Integrity sealing</div>
          <div class="content mt-4 text-[var(--muted)] text-sm leading-relaxed">
            After canonicalization, hashing and digital signatures are applied as reference implementations. Suite selection is configurable based on regulatory and operational requirements. Hashing establishes tamper-evidence; signatures establish origin authenticity.
          </div>
        </div>

        <div class="data-block p-8" data-open="keys" onclick="toggleBlock(this)">
          <div class="font-mono text-[10px] text-[var(--royal)] mb-4 tracking-[0.20em] uppercase">04 · Keys</div>
          <div class="font-bold text-lg mb-2 uppercase italic">Non-custodial</div>
          <div class="content mt-4 text-[var(--muted)] text-sm leading-relaxed">
            Signing keys remain in the client-controlled environment — HSM, KMS, or TEE. CEYO does not possess, transmit, or store private signing keys, preserving institution-led cryptographic authority.
          </div>
        </div>

        <div class="data-block p-8" data-open="disclosure" onclick="toggleBlock(this)">
          <div class="font-mono text-[10px] text-[var(--royal)] mb-4 tracking-[0.20em] uppercase">05 · Disclosure</div>
          <div class="font-bold text-lg mb-2 uppercase italic">Constrained</div>
          <div class="content mt-4 text-[var(--muted)] text-sm leading-relaxed">
            Artifacts may be disclosed under Public / Redacted or Controlled Review tiers. Tiering allows verification of integrity without default exposure of model weights, proprietary architecture, or confidential internals.
          </div>
        </div>

        <div class="data-block p-8" data-open="availability" onclick="toggleBlock(this)">
          <div class="font-mono text-[10px] text-[var(--royal)] mb-4 tracking-[0.20em] uppercase">06 · Availability</div>
          <div class="font-bold text-lg mb-2 uppercase italic">Fail-open</div>
          <div class="content mt-4 text-[var(--muted)] text-sm leading-relaxed">
            Inference continuity remains independent of artifact sealing. If artifact generation fails, inference proceeds uninterrupted. Failure events are logged and flagged; the artifact is marked as unsealed and becomes reviewable.
          </div>
        </div>
      </div>

      <div class="mt-14 flex justify-center gap-6 flex-wrap">
        <a href="platform.html" class="btn ghost">View Architecture</a>
        <a href="trust.html" class="btn ghost">Trust & Verification</a>
        <a href="governance.html" class="btn ghost">Governance</a>
        <a href="contact.html" class="btn primary">Request Controlled Review</a>
      </div>
    </section>

    <section id="boundary" class="section-pad opacity-60 hover:opacity-100 transition-opacity">
      <div class="border-t border-[var(--stroke)] pt-12">
        <div class="font-mono text-[10px] mb-8 uppercase tracking-widest">Boundary Declaration · V2026.02.19</div>
        <div class="grid md:grid-cols-2 gap-8 text-[10px] font-mono leading-relaxed uppercase text-[rgba(244,240,230,.70)]">
          <p>CEYO produces records. It does not validate correctness, fairness, legality, or compliance outcomes. Authorized institutions and operators retain responsibility for decisions and determinations.</p>
          <p>Verification confirms integrity and provenance under policy scope — not correctness of model output. CEYO does not certify regulatory compliance and does not guarantee legal admissibility.</p>
        </div>

        <div class="mt-12 pt-10 border-t border-[var(--stroke)] flex flex-wrap justify-between gap-6 font-mono text-[10px] uppercase tracking-widest opacity-70">
          <div>© <span id="year">2026</span> CEYO · All Rights Reserved</div>
          <div class="flex gap-8">
            <a href="terms.html" class="hover:text-[var(--royal)] transition-colors">Terms</a>
            <a href="privacy.html" class="hover:text-[var(--royal)] transition-colors">Privacy</a>
            <a href="contact.html" class="hover:text-[var(--royal)] transition-colors">Contact</a>
          </div>
        </div>
      </div>
    </section>

    <div style="height:72px"></div>
  </div>

  <nav id="bottombar" aria-label="Site index">
    <a href="index.html" class="active">INDEX</a>
    <a href="platform.html">ARCH</a>
    <a href="trust.html">TRUST</a>
    <a href="governance.html">GOV</a>
    <a href="contact.html">CONTACT</a>
  </nav>

  <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>

  <script>
    gsap.registerPlugin(ScrollTrigger);

    /* Cursor */
    const cursor = document.getElementById('cursor');
    if (window.matchMedia("(pointer: fine)").matches){
      document.addEventListener('mousemove', (e) => {
        gsap.to(cursor, {x: e.clientX, y: e.clientY, duration: 0.10, overwrite:true});
      }, {passive:true});
      document.querySelectorAll('a, button, .data-block').forEach(el => {
        el.addEventListener('mouseenter', () => cursor.classList.add('big'), {passive:true});
        el.addEventListener('mouseleave', () => cursor.classList.remove('big'), {passive:true});
      });
    }

    /* Top nav scroll */
    const topnav = document.getElementById('topnav');
    window.addEventListener('scroll', () => {
      topnav.classList.toggle('scrolled', window.scrollY > 24);
    }, {passive:true});

    /* Year */
    document.getElementById("year").textContent = new Date().getFullYear();

    /* Expand blocks */
    function toggleBlock(el){
      const key = el.getAttribute('data-open');
      el.classList.toggle('expanded');
      if (key){
        history.replaceState(null, "", "#" + key);
        focusMode("focus", 0.6); // subtle implode on click
      }
    }
    window.toggleBlock = toggleBlock;

    /* ===== THREE: neuron points + lines + core ball, with implode/zoom and explode between SECTIONS ===== */
    const canvas = document.getElementById('gl');
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(70, window.innerWidth/window.innerHeight, 0.1, 400);
    const renderer = new THREE.WebGLRenderer({ canvas, alpha:true, antialias:true, powerPreference:"high-performance" });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio || 1, 2));

    // Tunables
    const nodeCount = 260;
    const bounds = 16;
    const maxConnections = 1800;
    const linkDist = 2.35;
    const linkDist2 = linkDist * linkDist;

    // State machine
    const state = {
      // 0 = free network, 1 = imploded onto core shell
      implode: 0.0,
      // camera depth target
      camZ: 18.0,
      // orbit radius when imploded
      shell: 6.2,
      // extra impulse on transitions
      pulse: 0.0,
      // overall line alpha
      lineAlpha: 0.18
    };

    // Points (BufferGeometry)
    const positions = new Float32Array(nodeCount * 3);
    const velocities = new Float32Array(nodeCount * 3);
    const home = new Float32Array(nodeCount * 3); // original free positions (for explode return)
    const dirs = []; // stable directions for shell

    for (let i=0; i<nodeCount; i++){
      const k = i*3;
      const x = (Math.random()-0.5) * bounds*2;
      const y = (Math.random()-0.5) * bounds*2;
      const z = (Math.random()-0.5) * bounds*2;

      positions[k]=x; positions[k+1]=y; positions[k+2]=z;
      home[k]=x; home[k+1]=y; home[k+2]=z;

      velocities[k]   = (Math.random()-0.5) * 0.030;
      velocities[k+1] = (Math.random()-0.5) * 0.030;
      velocities[k+2] = (Math.random()-0.5) * 0.030;

      dirs.push(new THREE.Vector3((Math.random()-0.5),(Math.random()-0.5),(Math.random()-0.5)).normalize());
    }

    const pointsGeo = new THREE.BufferGeometry();
    pointsGeo.setAttribute('position', new THREE.BufferAttribute(positions, 3));
    const pointsMat = new THREE.PointsMaterial({
      color: 0x2D67FF,
      size: 0.06,
      transparent: true,
      opacity: 0.95,
      depthWrite: false
    });
    const points = new THREE.Points(pointsGeo, pointsMat);
    scene.add(points);

    // Lines (LineSegments)
    const linePositions = new Float32Array(maxConnections * 2 * 3);
    const lineGeo = new THREE.BufferGeometry();
    lineGeo.setAttribute('position', new THREE.BufferAttribute(linePositions, 3));
    lineGeo.setDrawRange(0,0);
    const lineMat = new THREE.LineBasicMaterial({
      color: 0x2D67FF,
      transparent: true,
      opacity: state.lineAlpha,
      depthWrite: false
    });
    const lines = new THREE.LineSegments(lineGeo, lineMat);
    scene.add(lines);

    // Core ball (wire)
    const core = new THREE.Mesh(
      new THREE.IcosahedronGeometry(2.6, 2),
      new THREE.MeshBasicMaterial({ color:0x2D67FF, wireframe:true, transparent:true, opacity:0.0 })
    );
    scene.add(core);

    // Core glow sprite
    const glowCanvas = document.createElement('canvas');
    glowCanvas.width = glowCanvas.height = 128;
    const gctx = glowCanvas.getContext('2d');
    const grad = gctx.createRadialGradient(64,64,0,64,64,64);
    grad.addColorStop(0, 'rgba(45,103,255,0.55)');
    grad.addColorStop(1, 'rgba(45,103,255,0.0)');
    gctx.fillStyle = grad; gctx.fillRect(0,0,128,128);
    const glowTex = new THREE.CanvasTexture(glowCanvas);
    const glow = new THREE.Sprite(new THREE.SpriteMaterial({ map: glowTex, transparent:true, opacity:0.0, depthWrite:false }));
    glow.scale.set(10,10,1);
    scene.add(glow);

    camera.position.z = state.camZ;

    // Mouse parallax
    let targetRotX = 0, targetRotY = 0;
    if (window.matchMedia("(pointer: fine)").matches){
      window.addEventListener('mousemove', (e) => {
        const nx = (e.clientX / window.innerWidth) * 2 - 1;
        const ny = (e.clientY / window.innerHeight) * 2 - 1;
        targetRotY = nx * 0.18;
        targetRotX = ny * 0.10;
      }, {passive:true});
    }

    function rebuildConnections(){
      const pos = pointsGeo.attributes.position.array;
      let segCount = 0;

      for (let i=0; i<nodeCount; i++){
        const ia = i*3;
        const ax = pos[ia], ay = pos[ia+1], az = pos[ia+2];

        for (let j=i+1; j<nodeCount; j++){
          const ib = j*3;
          const bx = pos[ib], by = pos[ib+1], bz = pos[ib+2];

          const dx=ax-bx, dy=ay-by, dz=az-bz;
          const d2=dx*dx+dy*dy+dz*dz;

          if (d2 < linkDist2){
            const k = segCount*6;
            linePositions[k]=ax; linePositions[k+1]=ay; linePositions[k+2]=az;
            linePositions[k+3]=bx; linePositions[k+4]=by; linePositions[k+5]=bz;
            segCount++;
            if (segCount >= maxConnections) break;
          }
        }
        if (segCount >= maxConnections) break;
      }

      lineGeo.setDrawRange(0, segCount*2);
      lineGeo.attributes.position.needsUpdate = true;
      lineMat.opacity = state.lineAlpha;
    }

    // Modes:
    // - "free": explode / network drift
    // - "focus": imploded to shell + visible core + closer cam
    function focusMode(mode, strength=1){
      if (mode === "focus"){
        gsap.to(state, { implode: 1, shell: 5.6, lineAlpha: 0.28, pulse: 0.35*strength, duration: 0.9, ease:"power3.out" });
        gsap.to(camera.position, { z: 11.6, duration: 1.0, ease:"power3.out" });
        gsap.to(core.material, { opacity: 0.40, duration: 0.8, ease:"power2.out" });
        gsap.to(glow.material, { opacity: 0.22, duration: 0.8, ease:"power2.out" });
      } else {
        gsap.to(state, { implode: 0, shell: 6.2, lineAlpha: 0.18, pulse: 0.55*strength, duration: 0.9, ease:"power3.out" });
        gsap.to(camera.position, { z: 16.8, duration: 1.0, ease:"power3.out" });
        gsap.to(core.material, { opacity: 0.12, duration: 0.9, ease:"power2.out" });
        gsap.to(glow.material, { opacity: 0.08, duration: 0.9, ease:"power2.out" });
      }
      // decay pulse
      gsap.to(state, { pulse: 0, duration: 1.6, ease:"power2.out", delay: 0.2 });
    }
    window.focusMode = focusMode;

    // SECTION TRANSITIONS (implode/zoom in hero -> explode on next section -> implode again on tech)
    ScrollTrigger.create({
      trigger: "#hero",
      start: "top top",
      end: "bottom top",
      onEnter: () => focusMode("focus", 1),
      onEnterBack: () => focusMode("focus", 1)
    });
    ScrollTrigger.create({
      trigger: "#gap",
      start: "top 70%",
      end: "bottom 30%",
      onEnter: () => focusMode("free", 1),
      onEnterBack: () => focusMode("free", 1)
    });
    ScrollTrigger.create({
      trigger: "#substrate",
      start: "top 70%",
      end: "bottom 30%",
      onEnter: () => focusMode("focus", 0.85),
      onEnterBack: () => focusMode("focus", 0.85)
    });
    ScrollTrigger.create({
      trigger: "#tech",
      start: "top 70%",
      end: "bottom 30%",
      onEnter: () => focusMode("free", 0.9),
      onEnterBack: () => focusMode("free", 0.9)
    });
    ScrollTrigger.create({
      trigger: "#boundary",
      start: "top 70%",
      end: "bottom 30%",
      onEnter: () => focusMode("focus", 0.7),
      onEnterBack: () => focusMode("focus", 0.7)
    });

    // Animation loop
    const tmp = new THREE.Vector3();
    const desired = new THREE.Vector3();
    const t0 = performance.now();

    function animate(){
      requestAnimationFrame(animate);
      const t = (performance.now() - t0) * 0.001;

      const pos = pointsGeo.attributes.position.array;

      // update points
      for (let i=0; i<nodeCount; i++){
        const k = i*3;

        // free drift (exploded state)
        pos[k]   += velocities[k]   * (1.0 - 0.65*state.implode);
        pos[k+1] += velocities[k+1] * (1.0 - 0.65*state.implode);
        pos[k+2] += velocities[k+2] * (1.0 - 0.65*state.implode);

        // bounds reflect when free
        if (state.implode < 0.98){
          if (pos[k] > bounds || pos[k] < -bounds) velocities[k] *= -1;
          if (pos[k+1] > bounds || pos[k+1] < -bounds) velocities[k+1] *= -1;
          if (pos[k+2] > bounds || pos[k+2] < -bounds) velocities[k+2] *= -1;
        }

        // implosion: move toward stable shell around core
        if (state.implode > 0.001){
          tmp.set(pos[k], pos[k+1], pos[k+2]);

          // shell breathe + pulse
          const breathe = 0.35 * Math.sin(t + i*0.17);
          const pulseKick = state.pulse * (0.9 + 0.1*Math.sin(t*2.0));
          desired.copy(dirs[i]).multiplyScalar(state.shell + breathe - pulseKick);

          // pull to desired
          tmp.lerp(desired, 0.010 + 0.040*state.implode);
          pos[k]=tmp.x; pos[k+1]=tmp.y; pos[k+2]=tmp.z;
        } else {
          // gentle return toward "home" when exploding (prevents drifting forever)
          const hx = home[k], hy = home[k+1], hz = home[k+2];
          pos[k]   += (hx - pos[k])   * 0.0015;
          pos[k+1] += (hy - pos[k+1]) * 0.0015;
          pos[k+2] += (hz - pos[k+2]) * 0.0015;
        }
      }

      pointsGeo.attributes.position.needsUpdate = true;

      // field rotation (mouse parallax)
      points.rotation.y += (targetRotY - points.rotation.y) * 0.04;
      points.rotation.x += (targetRotX - points.rotation.x) * 0.04;
      lines.rotation.copy(points.rotation);

      // core ball behavior (stronger when imploded)
      core.rotation.x += 0.002 + 0.001*state.implode;
      core.rotation.y += 0.003 + 0.001*state.implode;
      core.scale.setScalar(1.0 + 0.85*state.implode); // "zoom ball" feel
      glow.position.copy(core.position);
      glow.scale.setScalar(10 + 6*state.implode);

      // rebuild lines
      rebuildConnections();

      renderer.render(scene, camera);
    }
    animate();

    // Resize
    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setPixelRatio(Math.min(window.devicePixelRatio || 1, 2));
    }, {passive:true});
  </script>
</body>
</html>
